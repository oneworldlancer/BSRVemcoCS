@model BSRVemcoCS.iAppViewModel.AppDevelomentTable1EditViewModel

@* class="accordion-body" *@
<div id="div_PageHTMLContent" style="margin:0px;padding:0px;display:flex;flex-direction:column;">


   @*  <div class="row"> *@

@*     m-3 *@
    <table class="table table-hover table-bordered" style="margin-top:3px;margin-left:3px;margin-right:3px;width:100%;padding:3px;table-layout:fixed;background-color:white;">
            <thead>
                <tr>
                    <th>@Model.ColumnDescription</th>
                    <th>@Model.ColumnCommentary</th>
                    <th style="width:150px;">@Model.ColumnCriterion</th>
                    <th class="fw-bold" style="width:50px;background-color:#dde9f5;">@Model.ColumnScore</th>
                    <th>@Model.ColumnRiskControlMeasure</th>
                    <th class="fw-bold" style="width:110px;background-color:#dde9f5;">@Model.ColumnScoreAdjused </th>
                    @*<th class="fw-bold" style="width:50px;">Total</th>*@

                </tr>
            </thead>
            <tbody id="div_ItemsList">

                @*    <div> *@

                @await Component.InvokeAsync("BuildingTable3List",
                new {
                bldtknid = Model.BuildingTokenID,
                iPageNumber = "0",
                blnIsPaging = true
                })

                @*  </div> *@




            </tbody>
        </table>


        <div class="mt-5" style="vertical-align:middle;display:flex;flex-direction:row;justify-content:space-between;">

            <div class="float-start"></div>
            <div>
                <div id="div_Paging_0" style="display:block;margin:auto;vertical-align:middle;">
                    <nav>
                        <ul class="pagination">

                            <li class="page-item">
                                @* *@

                                @*                                     onclick="load_TablePageNumberList('@Model.BuildingTokenID', '0', 'true','1', true)" *@
                                <a href='#div_ItemsList' id="pager1_0" class="page-link active"
                                   onclick="load_TablePageNumberList('@Model.BuildingTokenID', '0', 'true','1', true)">1</a>
                            </li>
                            <li class="page-item">
                                <a href='#div_ItemsList' id="pager2_0" class="page-link"
                                   onclick="load_TablePageNumberList('@Model.BuildingTokenID', '0', 'true','2', true)">2</a>
                            </li>
                            <li class="page-item">
                                <a href='#div_ItemsList' id="pager3_0" class="page-link"
                                   onclick="load_TablePageNumberList('@Model.BuildingTokenID', '0', 'true','3', true)">3</a>
                            </li>

                            <li class="page-item">
                                <a href='#div_ItemsList' id="pager4_0" class="page-link"
                                   onclick="load_TablePageNumberList('@Model.BuildingTokenID', '0', 'true','4', true)">4</a>
                            </li>

                            @*   <li class="page-item">
                            <a href='#collapse444' id="pager3_444" class="page-link">4</a>
                            </li>

                            <li class="page-item">
                            <a href='#collapse555' id="pager3_555" class="page-link">5</a>
                            </li>

                            <li class="page-item">
                            <a href='#collapse666' id="pager3_666" class="page-link">6</a>
                            </li> *@

                        </ul>
                    </nav>
                </div>
            </div>

            <div class="float-end"></div>
        </div>


   @*  </div> *@

    @*     <input id="hdn_InformationTokenID" name="hdn_InformationTokenID" type="hidden" value="0" />
    <input id="iAppinformationTokenID" name="iAppinformationTokenID" type="hidden" value="0" />
    <input id="iInformationTokenID" name="iInformationTokenID" type="hidden" value="0" />
    <input id="iBuildingTokenID" name="iBuildingTokenID" type="hidden" value="0" />
    <input id="iDocumentTokenID" name="iDocumentTokenID" type="hidden" value="0" />
    <input id="iTimeFrame" name="iTimeFrame" type="hidden" value="0" />
    <input id="iDocumentCount" name="iDocumentCount" type="hidden" value="0" />
    *@

    @*POPUP*@
    <div class="modal" id="popupModalEditor">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header" style="background-color:whitesmoke;">
                    <h4 class="modal-title">Resident Engagement</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">



                    <div id="popup_FormContent">
                        @* @await Component.InvokeAsync("Editor")*@


                        <div class="ms-3 me-3 mb-3">
                            <label class="form-label">Adjusted Score:</label>
                            <input class="form-control"
                                   type="number" id="iScoreAdjusted" name="iScoreAdjusted" min="1" max="5">

                        </div>

                        <div class="ms-3 me-3 mb-3">
                            <label class="form-label">Risk Control Measure:</label>
                            <textarea id="txt_HTMLContent" name="txt_HTMLContent" style="width:100%;height:auto;" rows="20" class="form-control">
                                        default
                                    </textarea>

                        </div>

                        @*@Model.PageHTMLContent*@



                        @* <div id="txt_HTMLContent" style="height:200px;"></div>*@


                    </div>



                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    @*data-bs-dismiss="modal"*@   <button type="button" class="btn btn-primary"
                                                          onclick="Popup_PostForm( );">
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </div>



    @*    <script src="https://cdn.ckeditor.com/ckeditor5/39.0.0/classic/ckeditor.js"></script>


    <script>

    let editor;

    ClassicEditor
    .create(document.querySelector('#txt_HTMLContent'))
    .then(newEditor => {
    editor = newEditor;
    })
    .catch(error => {
    console.error(error);
    });







    </script> *@


</div>


<script src="https://cdn.ckeditor.com/ckeditor5/39.0.0/classic/ckeditor.js"></script>

<script>

    let editor;

    ClassicEditor
        .create(document.querySelector('#txt_HTMLContent'))
        .then(newEditor => {
            editor = newEditor;
        })
        .catch(error => {
            console.error(error);
        });







</script>





<script>

    function clickRow(obj) {

        try {

            //alert(' am clicked == ' + $('#popupModalEditor'));

            //jQuery.noConflict();
            $('#popupModalEditor').modal('show');

        }

        catch (ex) {
            alert(ex);

        }
    }



    function readValue(obj) {

        try {

            // var divTestMe = document.getElementById('divTestMe');
            // var divTestMe = document.getElementById('txt_HTMLContent');
            // var divTestMe = document.getElementById('iScoreAdjusted');

            //   alert(divTestMe.innerHTML);
            //alert(divTestMe.textContent);
            //   alert(divTestMe.innerHTML);

            //   alert($("#txt_HTMLContent").val());

            //  alert( ClassicEditor.instances[ 'txt_HTMLContent' ].getData());

            alert(editor.getData());

            //jQuery.noConflict();
            //$('#popupModalEditor').modal('show');

        }

        catch (ex) {
            alert(ex);

        }
    }




    // window.apptbltknid;
    // window.tbltknid;
    // window.bldtknid;
    // window.inftknid;
    // window.clmscore;
    // window.clmrisk;

    function Popup_PostForm() {

        try {

            //alert('inftknid == ' + window.inftknid);

            var clmn_Score = $("[data-clmscore='clmscore_" + inftknid + "']");
            var clmn_RiskMeasure = $("[data-clmrisk='clmrisk_" + inftknid + "']");
            var clmn_Total = $("[data-clmtotal='clmtotal']");

            var txt_RiskControlMeasure = '0';
            var visible_RiskControlMeasure = '0';

            if (editor.getData() == '') {
                txt_RiskControlMeasure = "0";
                visible_RiskControlMeasure = "";
            }
            else {
                txt_RiskControlMeasure = editor.getData();
                visible_RiskControlMeasure = editor.getData();

            }

            var iScoreAdjusted = document.getElementById('iScoreAdjusted');



            $.ajax({
                type: "POST",

                //url: @Url.Action("Update_Score_ByInformationTokenID","Development",new { Area = "iWebMember" }),
                url: '/iWebMember/Development/Update_Score_ByInformationTokenID',

                data: {
                    iAppTableTokenID: apptbltknid,
                    iTableTokenID: tbltknid,
                    iBuildingTokenID: bldtknid,
                    iInformationTokenID: inftknid,
                    iScoreAdjusted: iScoreAdjusted.value,
                    iRiskControlMeasure: txt_RiskControlMeasure
                },
                success: function (result) {


                    clmn_Score.html(iScoreAdjusted.value);
                    clmn_RiskMeasure.html(visible_RiskControlMeasure);
                    clmn_Total.html(result.total);


                    BSR_ShowToastMessage('update');



                },
                error: function () {
                    alert('Failed to receive the Data');
                    console.log('Failed ');
                }
            });




            $('#popupModalEditor').modal('hide');







            //////$.ajax({
            //////    url: "/iWebMember/Development/GetImage",
            //////    type: 'POST',
            //////    //dataType: 'json',
            //////    data: { divhtml: $("#div_diagram").html() },
            //////    success: function (data) { }
            //////});










            //////   // var divTestMe = document.getElementById('divTestMe');
            //////var divTestMe = document.getElementById('txt_HTMLContent');

            ////// //   alert(divTestMe.innerHTML);
            //////    alert(divTestMe.textContent);

            //////    //jQuery.noConflict();
            //////    //$('#popupModalEditor').modal('show');

        }

        catch (ex) {
            alert(ex);

        }
    }



    function Popup_LoadForm(apptbltknid, tbltknid, bldtknid, inftknid, clmscore, clmrisk) {

        try {

            // alert('Popup_LoadForm Popup_LoadForm Popup_LoadForm');

            // alert('popup form here' + bldtknid + " , " + inftknid + " , " + clmscore + " , " + clmrisk);

            // alert('popup form here' + editor);


            window.apptbltknid = apptbltknid;
            window.tbltknid = tbltknid;
            window.bldtknid = bldtknid;
            window.inftknid = inftknid;
            window.clmscore = clmscore;
            window.clmrisk = clmrisk;

            //alert('popup form here' + bldtknid + " , " + inftknid + " , " + clmscore + " , " + clmrisk);

            var clmn_Score = $("[data-clmscore='clmscore_" + inftknid + "']");
            var clmn_RiskMeasure = $("[data-clmrisk='clmrisk_" + inftknid + "']");

            var txt_RiskControlMeasure = '0';

            if (editor.getData() == '') {
                txt_RiskControlMeasure = "0";
            }
            else {
                txt_RiskControlMeasure = editor.getData();

            }


            //////if (editor.getData() == '') {
            //////    txt_RiskControlMeasure = "0";
            //////}
            //////else {
            //////    txt_RiskControlMeasure = editor.getData();

            //////}

            ////////alert(clmn_Score.html());

            //
            //
            //   alert($("[data-clmnscore='clmscore_1689793069675']").html());



            //var divTestMe = document.getElementById('txt_HTMLContent');
            var iScoreAdjusted = document.getElementById('iScoreAdjusted');

            //  iScoreAdjusted.value = '3';
            iScoreAdjusted.value = clmn_Score.html();

            editor.setData(clmn_RiskMeasure.html());


            //var txt_HTMLContent = document.getElementById('txt_HTMLContent');
            // txt_HTMLContent.value = 'txt_HTMLContent 333';

            //alert(divTestMe.innerHTML);
            //  alert(divTestMe.textContent);
            // alert('updatd popup value == ' + bldtknid);

            //  var editorData =  ClassicEditor.instances[ 'txt_HTMLContent' ];

            //  CKEDITOR.ClassicEditor.instances[ 'txt_HTMLContent' ].setData('txt_HTMLContent 333');



            //  alert(editorData);



            $('#popupModalEditor').modal('show');


            //clmn_Score.html('112');
            //clmn_RiskMeasure.html('<p> Some text 123 hello world </p>');

            // var txt_HTMLContent = document.getElementById('txt_HTMLContent');
            //  txt_HTMLContent.innerHTML = 'txt_HTMLContent 333';


            //  $('#txt_HTMLContent').val('some_value');
            //   $("#main").val(text);

            // alert(divTestMe.textContent);







            //////$.ajax({
            //////    type: "POST",

            //////    //url: @Url.Action("Update_Score_ByInformationTokenID","Development",new { Area = "iWebMember" }),
            //////    url: '/iWebMember/Development/Update_Score_ByInformationTokenID',

            //////    data: {
            //////        iBuildingTokenID: bldtknid,
            //////        iInformationTokenID: bldtknid,
            //////        iScoreAdjusted: bldtknid,
            //////        iRiskControlMeasure: inftknid
            //////    },
            //////    success: function (result) {
            //////        //alert('Successfully received Data ');
            //////        //console.log(result);
            //////        document.getElementById("popup_FormContent").innerHTML = result;
            //////        $('#popupModalEditor').modal('show');
            //////    },
            //////    error: function () {
            //////        alert('Failed to receive the Data');
            //////        console.log('Failed ');
            //////    }
            //////});






            //////$.ajax({
            //////    type: "GET",

            //////    //url: @Url.Action("Popup_GetEditor","BSRVemcoPopup",new { Area = "iWebMember" }),
            //////    url: '/iWebMember/BSRVemcoPopup/Popup_GetEditor',

            //////    data: {
            //////        bldtknid: bldtknid,
            //////        inftknid: inftknid
            //////    },
            //////    success: function (result) {
            //////        //alert('Successfully received Data ');
            //////        //console.log(result);
            //////        document.getElementById("popup_FormContent").innerHTML = result;
            //////        $('#popupModalEditor').modal('show');
            //////    },
            //////    error: function () {
            //////        alert('Failed to receive the Data');
            //////        console.log('Failed ');
            //////    }
            //////});






            //    $.ajax({

            //        type: 'get',

            //        url: @Url.Action("Popup_GetEditor","BSRVemcoPopup",new { Area = "iWebMember" }),//'/Controller/Method',
            //        data: {
            //             bldtknid: bldtknid,
            //            inftknid: inftknid
            //        },
            //        success: function (result) {

            //            alert("result == " + result);

            //            //  document.getElementById("popup_FormContent").innerHTML= result;


            //        }

            //    });
            //});

            // $('#popupModalEditor').modal('show');



            //////    //////$.ajax({
            //////    //////    type: 'GET',
            //////    //////    url: '/Controller/Method',
            //////    //////    data: { ParamName: document.getElementById("DivId").innerHTML },
            //////    //////    success: function (result) {

            //////    //////    }
            //////    //////});
            //////});








            //////   // var divTestMe = document.getElementById('divTestMe');
            //////var divTestMe = document.getElementById('txt_HTMLContent');

            ////// //   alert(divTestMe.innerHTML);
            //////    alert(divTestMe.textContent);

            //////    //jQuery.noConflict();
            //////    //$('#popupModalEditor').modal('show');

        }

        catch (ex) {
            //  alert(ex);
            console.log(ex);
        }
    }





    function load_TablePageNumberList(iBuildingTokenID, iQueryTableTokenID, blnIsPaging, iPageNumber, blnIsNewRefresh) {


        try {

            // alert('load_TabPageNumberList XXX');


            BSR_ShowToastMessage('load');

            window.bldtknid = iBuildingTokenID;
            //window.querytbltknid = iQueryTableTokenID;


            //$("#iQueryTableTokenID").val(iQueryTableTokenID);
            $("#iBuildingTokenID").val(iBuildingTokenID);

            $.ajax({

                url: '/iWebMember/Development/ReloadBuildingTable3List',
                data: {
                    bldtknid: iBuildingTokenID,//$("#iBuildingTokenID").val(),//document.getElementById("cbShowPrevious").checked,
                    //querytbltknid: $("#iQueryTableTokenID").val(), //document.getElementById("cbShowUpcoming").checked
                    iPageNumber: iPageNumber, //document.getElementById("cbShowUpcoming").checked
                    blnIsPaging: blnIsPaging //document.getElementById("cbShowUpcoming").checked
                },
                success: function (data) {

                    $("#div_ItemsList").html(data);

                    let _blnIsPagingList = blnIsPaging.toLowerCase();

                    //alert('_blnIsPagingList == ' + _blnIsPagingList);


                    // var companyElements = $("ul:data(group) li:data(company)");
                    //  var companyElements = $("ul:data(group) li:data(company)");

                    if (_blnIsPagingList == "true") {


                        $("#pager1_" + iQueryTableTokenID).removeClass("active");
                        $("#pager2_" + iQueryTableTokenID).removeClass("active");
                        $("#pager3_" + iQueryTableTokenID).removeClass("active");

                        // $("#pager1_" + iQueryTableTokenID).removeClass("active");
                        //                          $("#pager2_" + iQueryTableTokenID).removeClass("active");
                        //                          $("#pager3_" + iQueryTableTokenID).removeClass("active");


                        if (iPageNumber == "0") {
                            $("#pager1_" + iQueryTableTokenID).addClass("active");

                        }

                        else if (iPageNumber == "1") {
                            $("#pager1_" + iQueryTableTokenID).addClass("active");

                        }
                        else if (iPageNumber == "2") {
                            $("#pager2_" + iQueryTableTokenID).addClass("active");

                        }

                        else if (iPageNumber == "3") {
                            $("#pager3_" + iQueryTableTokenID).addClass("active");

                        }
                        else if (iPageNumber == "4") {
                            $("#pager4_" + iQueryTableTokenID).addClass("active");

                        }

                        $("#div_Paging_" + iQueryTableTokenID).show();

                    } else {
                        $("#div_Paging_" + iQueryTableTokenID).hide();

                    }



                    // $('#div_CommandEdit').hide();
                    // ////////$('#div_CommandPreview').hide();
                    // $('#div_CommandUpload').hide();

                    //alert('load_TabPageNumberList DONE !!!');
                }
            });


        }
        catch (err) {
            //alert(err);
            console.error(err);
            return;

        }

    }






</script>


